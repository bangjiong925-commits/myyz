# 号码交集功能使用指南 v1.0.0.10

## 🎯 功能简介

在"做号拼接"页面中，新增了**号码交集模式**，可以自动对相同星级的模块进行交集，无需手动选择模块。

---

## 📖 使用步骤

### 1️⃣ 准备数据

在下方的8个输入模块中粘贴做号结果：

```
模块1: 粘贴5星号码（例如：10注）
模块3: 粘贴5星号码（例如：8注）
模块5: 粘贴5星号码（例如：12注）
模块2: 粘贴3星号码（例如：15注）
模块4: 粘贴3星号码（例如：20注）
```

### 2️⃣ 切换到交集模式

点击顶部的 **⚡ 交集模式** 按钮

- 系统会自动显示"交集配置区域"
- 自动扫描并显示检测到的模块信息

### 3️⃣ 查看自动检测结果

系统会显示类似以下信息：

```
📊 自动检测到的模块：

5星: 模块1(10注), 模块3(8注), 模块5(12注)
共30注 [✓ 可交集]

3星: 模块2(15注), 模块4(20注)
共35注 [✓ 可交集]
```

- **绿色标签**：表示该星级有≥2个模块，可以进行交集
- **灰色标签**：表示该星级只有1个模块，无法交集（会跳过）

### 4️⃣ 设置容错值

点击容错按钮选择容错值（默认为0）：

- **0**: 必须完全相同才交集（最严格）
- **1**: 允许1个数字不同
- **2**: 允许2个数字不同
- ...
- **8**: 允许8个数字不同（最宽松）

💡 **容错值越大，交集结果越多**

### 5️⃣ 点击"拼接"按钮执行交集

- 系统会自动对每个星级组进行交集计算
- 显示结果到号码显示区域

### 6️⃣ 查看结果

结果会显示：
```
共 165 注 (5星: 45注 | 3星: 120注)
```

弹窗提示：
```
✅ 交集完成！

5星: 45注
3星: 120注
─────────
总计: 165注
```

---

## 🔧 工作原理

### 自动扫描逻辑

1. **扫描模块**：遍历8个输入模块（textarea）
2. **识别星级**：根据每行号码的数字个数判断星级
3. **分组**：将相同星级的模块归为一组
4. **检查可行性**：只有≥2个模块的星级组才能进行交集

### 交集算法

对于每个星级组（例如5星有3个模块）：

1. **模块1 ∩ 模块2** = 中间结果1
2. **中间结果1 ∩ 模块3** = 最终结果

每次交集时：
- 比较两个号码的相同数字个数
- 如果差异数字个数 ≤ 容错值，则保留
- 合并两个号码，去重并排序

### 容错机制示例

假设5星号码，容错值为1：

```
号码A: 01,03,05,07,09
号码B: 01,03,05,07,10  (只有1个不同: 09 vs 10)

差异个数 = 1
容错值 = 1
结果：符合条件，保留组合
```

---

## 💡 使用技巧

### ✅ 最佳实践

1. **准备充分的数据**：至少每个星级有2个模块才能交集
2. **合理设置容错**：
   - 数据量大时，用容错0（精确交集）
   - 数据量小时，用容错1-2（适度放宽）
3. **分批处理**：如果模块很多，可以分组进行交集

### ❌ 常见问题

**Q1: 为什么点击后提示"没有检测到任何模块数据"？**
- 检查输入模块是否为空
- 确认号码格式正确（逗号或空格分隔）

**Q2: 为什么交集结果为空？**
- 各模块号码差异过大
- 容错值设置过小
- 建议：逐步增加容错值再试

**Q3: 为什么某个星级没有交集结果？**
- 该星级只有1个模块（无法交集）
- 或者该星级的模块号码完全不匹配

**Q4: 切换回拼接模式怎么操作？**
- 点击顶部的 **🔗 拼接模式** 按钮即可

---

## 🎨 界面说明

### 模式切换区域

```
┌─────────────────────────────────────┐
│  🔗 拼接模式   ⚡ 交集模式          │
├─────────────────────────────────────┤
│  📊 自动检测到的模块：              │
│  ┌─────────────────────────────┐   │
│  │ 5星: 模块1(10注), ...       │   │
│  │ 3星: 模块2(15注), ...       │   │
│  └─────────────────────────────┘   │
│                                     │
│  ⚙️ 容错设置                        │
│  [0][1][2][3][4][5][6][7][8]       │
│  💡 容错值越大，交集结果越多        │
└─────────────────────────────────────┘
```

### 按钮状态

- **激活状态**：蓝色/紫色背景，白色文字
- **未激活状态**：白色背景，灰色文字

---

## 📊 实际案例

### 案例1：双模块5星交集

**输入：**
```
模块1 (5星):
01,02,03,04,05
02,03,04,05,06
03,04,05,06,07

模块3 (5星):
01,02,03,04,05
02,03,04,05,07
03,04,05,06,08
```

**容错值：0**

**输出：**
```
01,02,03,04,05  (两个模块都有)

结果：1注
```

### 案例2：三模块3星交集（容错1）

**输入：**
```
模块2 (3星):
01,02,03
01,02,04
01,03,04

模块4 (3星):
01,02,03
01,02,05
02,03,04

模块6 (3星):
01,02,03
01,03,05
```

**容错值：1**

**输出：**
```
01,02,03  (三个模块都有)
01,02,03,04  (容错1，合并结果)
01,02,03,05  (容错1，合并结果)
...

结果：若干注（取决于容错匹配情况）
```

---

## 🔄 版本历史

- **v1.0.0.10** (2025-10-18)
  - ✨ 新增号码交集功能
  - 🎯 自动扫描和星级分组
  - ⚙️ 容错机制（0-8）
  - 📊 实时模块检测显示

---

## 🆚 拼接模式 vs 交集模式

| 特性 | 拼接模式 | 交集模式 |
|------|----------|----------|
| **目的** | 组合不同位置的号码 | 找出共同号码 |
| **输入** | 需要选择拼接位置 | 自动识别相同星级 |
| **算法** | 笛卡尔积组合 | 集合交集 |
| **结果量** | 通常较多 | 通常较少（更精确） |
| **适用场景** | 扩大号码覆盖面 | 缩小号码范围，提高命中率 |

---

## 📞 技术支持

如有问题，请联系 ✈️ @suibian925

---

**更新时间**: 2025-10-18 02:35
**文档版本**: 1.0

