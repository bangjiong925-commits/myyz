<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>台湾PK数据分析工具</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- Tailwind配置 -->
  
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .sticky-header {
        position: sticky;
        top: 0;
        z-index: 10;
      }
      .sticky-col {
        position: sticky;
        z-index: 20;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .hit-cell {
        @apply bg-primary/20 text-primary font-bold;
      }
      .miss-cell {
        @apply text-gray-400;
      }
      .btn-active {
        @apply bg-primary text-white;
      }
      .btn-hover {
        @apply hover:bg-primary/80 hover:text-white transition-colors duration-200;
      }
      .number-row {
        @apply flex justify-center space-x-1 mb-1;
      }
      .fixed-width-period {
        width: 120px;
      }
      .fixed-width-data {
        width: 150px;
      }
      .sticky-bg-white {
        background-color: white !important;
      }
      .sticky-bg-gray-100 {
        background-color: #f3f4f6 !important;
      }
      .sticky-bg-gray-50 {
        background-color: #f9fafb !important;
      }
      .slider-container {
        @apply relative h-6 mt-2 mb-4;
      }
      .slider-track {
        @apply absolute h-2 w-full bg-gray-200 rounded-full;
      }
      .slider-thumb {
        @apply absolute w-5 h-5 bg-primary rounded-full cursor-pointer -mt-1.5 -ml-2.5;
      }
      .slider-fill {
        @apply absolute h-2 bg-primary rounded-full;
      }
      .vertical-slider-container {
        @apply absolute right-0 top-0 h-full w-4 flex items-center justify-center z-10;
      }
      .vertical-slider-track {
        @apply absolute h-full w-1 bg-gray-200 rounded-full;
      }
      .vertical-slider-thumb {
        @apply absolute w-4 h-6 bg-primary rounded-md cursor-pointer -ml-1.5;
      }
      .vertical-slider-fill {
        @apply absolute w-1 bg-primary rounded-full;
      }
      /* 限制表格容器高度，最多显示11行 */
      .table-container {
        max-height: calc(11 * 52px); /* 每行约52px高度 */
        overflow-y: auto;
        position: relative;
      }
    }
  </style>
</head>
<body class="bg-gray-50 font-sans text-dark min-h-screen flex flex-col">
  <!-- 密钥倒计时通知栏 -->
  <div id="keyCountdown" class="bg-primary text-white py-2 px-4 text-center hidden">
    <span>密钥有效期剩余: <strong id="timeRemaining">0天 0小时 0分钟 0秒</strong></span>
  </div>
  
  <!-- 顶部导航 -->
  <header class="bg-white shadow-sm sticky-header">
  <!-- 标题区域 - 移至最顶部 -->
  <div class="container mx-auto px-4 py-3 flex flex-wrap items-center justify-between">
      <h1 class="text-xl md:text-2xl font-bold text-primary flex items-center">
        <i class="fa fa-line-chart mr-2"></i>台湾PK数据分析工具
      </h1>
      <div class="flex items-center space-x-2 mt-2 md:mt-0">
        <button id="helpBtn" class="p-2 rounded-full hover:bg-gray-100 transition-colors duration-200" title="帮助">
          <i class="fa fa-question-circle text-gray-500"></i>
        </button>
        <button id="themeToggle" class="p-2 rounded-full hover:bg-gray-100 transition-colors duration-200" title="切换主题">
          <i class="fa fa-moon-o text-gray-500"></i>
        </button>
      </div>
    </div>
    
  <!-- 工具栏区域 - 移至标题下方 -->
  <div class="bg-gray-800 text-white py-2">
    <div class="container mx-auto px-4">
      <div class="flex space-x-4">
        <button id="dataAnalysisBtn" class="px-4 py-1 rounded bg-primary text-white font-medium">数据分析</button>
        <button id="fiveStarBtn" class="px-4 py-1 rounded bg-gray-600 text-white font-medium hover:bg-primary transition-colors">五星做号</button>
      </div>
    </div>
  </div>
  </header>

  <!-- 主要内容 -->
  <main class="flex-1 container mx-auto px-4 py-6">
    <!-- 数据分析页面 -->
    <div id="dataAnalysisPage">
      <!-- 数据输入区域 -->
      <section class="bg-white rounded-lg shadow-md p-5 mb-6">
        <div class="flex flex-col md:flex-row md:items-center gap-4">
          <div class="flex-1">
            <label for="numbersInput" class="block text-sm font-medium text-gray-700 mb-1">手动输入数据（支持格式：期数 数据，如：202504181232 02,05,01,04,07,10,09,03,06,08 ）</label>
            <textarea id="numbersInput" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all duration-200" placeholder="202504181232 02,05,01,04,07,10,09,03,06,08"></textarea>
          </div>
          <div class="flex flex-col gap-3 w-full md:w-auto">
            <button id="calcBtn" class="px-4 py-2 bg-primary text-white rounded-md flex items-center justify-center btn-hover">
              <i class="fa fa-calculator mr-2"></i>计算分析
            </button>
            <button id="autoFetchBtn" class="px-4 py-2 bg-secondary text-white rounded-md flex items-center justify-center btn-hover">
              <i class="fa fa-refresh mr-2"></i>自动获取数据
            </button>
            <button id="uploadDataBtn" class="px-4 py-2 bg-gray-600 text-white rounded-md flex items-center justify-center btn-hover">
              <i class="fa fa-upload mr-2"></i>上传数据文件
            </button>
          </div>
        </div>
        <div id="output" class="mt-3 text-sm text-primary"></div>
      </section>

      <!-- 筛选和统计控制区域 -->
      <section class="bg-white rounded-lg shadow-md p-5 mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- 胆码数筛选 -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">胆码数筛选：</label>
            <div id="numButtons" class="flex flex-wrap gap-2"></div>
          </div>
          
          <!-- 中出筛选 -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">中出筛选：</label>
            <div id="hitButtons" class="flex flex-wrap gap-2"></div>
          </div>
          
          <!-- 自定义组合 -->
          <div class="md:col-span-2">
            <label for="customCombos" class="block text-sm font-medium text-gray-700 mb-1">自定义组合（用空格分隔不同组合，每个组合内的数字用逗号分隔）：</label>
            <textarea id="customCombos" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all duration-200" placeholder="1,2,3 1,2,4"></textarea>
          </div>
        </div>
        
        <!-- 操作按钮 -->
        <div class="flex flex-wrap gap-3 mt-5">
          <button id="sortToggle" class="px-4 py-2 bg-gray-700 text-white rounded-md flex items-center btn-hover">
            <i class="fa fa-sort mr-2"></i><span id="sortText">按连中次数排序</span>
          </button>
          <button id="statBtn" class="px-4 py-2 bg-gray-700 text-white rounded-md flex items-center btn-hover">
            <i class="fa fa-bar-chart mr-2"></i>更新统计
          </button>
          <button id="exportBtn" class="px-4 py-2 bg-gray-700 text-white rounded-md flex items-center btn-hover">
            <i class="fa fa-download mr-2"></i>导出数据
          </button>
          <button id="clearBtn" class="px-4 py-2 bg-gray-700 text-white rounded-md flex items-center btn-hover">
            <i class="fa fa-trash mr-2"></i>清空数据
          </button>
        </div>
        
        <!-- 统计摘要 -->
        <div id="summary" class="mt-4 p-3 bg-gray-50 rounded-md text-sm font-medium"></div>
      </section>

      <!-- 结果表格 -->
      <section class="bg-white rounded-lg shadow-md p-5 overflow-x-auto relative">
        <div class="flex flex-wrap justify-between items-center mb-4 gap-3">
          <div class="flex items-center gap-3">
            <h2 class="text-lg font-semibold">数据分析结果</h2>
            <!-- 统一的按钮组 -->
            <div class="flex gap-1">
              <!-- 当前/历史切换 -->
              <div class="flex rounded-md overflow-hidden border border-gray-300">
                <button id="currentBtn" class="px-3 py-1 bg-gray-200 text-gray-700 btn-hover text-sm">历史</button>
                <button id="historyBtn" class="px-3 py-1 bg-blue-600 text-white btn-hover text-sm btn-active">当前</button>
              </div>
              <!-- 遗漏/连中切换 -->
              <div class="flex rounded-md overflow-hidden border border-gray-300">
                <button id="missBtn" class="px-3 py-1 bg-blue-600 text-white btn-hover text-sm btn-active">遗漏</button>
                <button id="hitBtn" class="px-3 py-1 bg-gray-200 text-gray-700 btn-hover text-sm">连中</button>
              </div>
            </div>
          </div>
          <div class="flex flex-wrap gap-2">
            <button class="period-btn px-3 py-1 rounded-md bg-gray-200 btn-hover btn-active" data-period="30">30期</button>
            <button class="period-btn px-3 py-1 rounded-md bg-gray-200 btn-hover" data-period="50">50期</button>
            <button class="period-btn px-3 py-1 rounded-md bg-gray-200 btn-hover" data-period="100">100期</button>
            <div class="flex items-center gap-1">
              <input type="number" id="customPeriod" min="1" max="10000" value="30" class="w-16 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary">
              <button id="customPeriodBtn" class="px-3 py-1 rounded-md bg-gray-200 btn-hover">自定义</button>
            </div>
          </div>
          <div class="text-sm text-gray-500">
            <span id="periodCount">0</span> 期数据
          </div>
        </div>
        
        <!-- 水平滑块 -->
        <div class="slider-container">
          <div class="slider-track"></div>
          <div class="slider-fill" id="horizontalFill"></div>
          <div class="slider-thumb" id="horizontalThumb"></div>
        </div>
        
        <div class="relative">
          <div class="overflow-x-auto scrollbar-hide" id="tableContainer">
            <table id="resultTable" class="min-w-full divide-y divide-gray-200">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
          
          <!-- 垂直滑块 -->
          <div class="vertical-slider-container" id="verticalSlider">
            <div class="vertical-slider-track"></div>
            <div class="vertical-slider-fill" id="verticalFill"></div>
            <div class="vertical-slider-thumb" id="verticalThumb"></div>
          </div>
        </div>
      </section>
    </div>
    
    <!-- 五星做号页面（按图片布局） -->
    <div id="fiveStarPage" class="hidden">
      <div class="container mx-auto py-8">
        <div class="bg-white rounded-lg shadow-md p-6">
           <!-- 下方添加区域 - 所有模块统一容器 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="modules-container">
            <!-- 左侧卡片 - 模块1 (5组筛选条件) -->
        <div id="module1" class="border border-gray-200 rounded-lg p-4 five-star-module">
          <!-- 模块级共享容错选择器 -->
          <div class="flex items-center mb-2 pb-4 border-b">
            <span class="text-gray-600 mr-2">模块容错</span>
            <select class="tolerance-min border border-gray-300 rounded px-2 py-1 text-sm" data-module="1">
              <option>0</option>
            </select>
            <span class="mx-2">至</span>
            <select class="tolerance-max border border-gray-300 rounded px-2 py-1 text-sm" data-module="1">
              <option>0</option>
            </select>
          </div>
          
          <!-- 第1组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="1" data-group="1">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="1" data-group="1">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="1" data-group="1">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="1" data-group="1">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="1" data-group="1">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="1" data-group="1">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="1" data-group="1">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="1" data-group="1">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="1" data-group="1">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="1" data-group="1">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="1" data-group="1">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="1" data-group="1">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="1" data-group="1">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="1" data-group="1">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="1" data-group="1">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="1" data-group="1">5胆</button>
            </div>
          </div>
          
          <!-- 第2组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="1" data-group="2">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="1" data-group="2">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="1" data-group="2">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="1" data-group="2">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="1" data-group="2">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="1" data-group="2">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="1" data-group="2">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="1" data-group="2">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="1" data-group="2">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="1" data-group="2">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="1" data-group="2">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="1" data-group="2">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="1" data-group="2">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="1" data-group="2">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="1" data-group="2">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="1" data-group="2">5胆</button>
            </div>
          </div>
          
          <!-- 第3组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="1" data-group="3">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="1" data-group="3">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="1" data-group="3">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="1" data-group="3">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="1" data-group="3">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="1" data-group="3">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="1" data-group="3">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="1" data-group="3">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="1" data-group="3">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="1" data-group="3">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="1" data-group="3">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="1" data-group="3">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="1" data-group="3">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="1" data-group="3">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="1" data-group="3">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="1" data-group="3">5胆</button>
            </div>
          </div>
          
          <!-- 第4组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="1" data-group="4">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="1" data-group="4">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="1" data-group="4">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="1" data-group="4">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="1" data-group="4">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="1" data-group="4">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="1" data-group="4">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="1" data-group="4">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="1" data-group="4">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="1" data-group="4">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="1" data-group="4">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="1" data-group="4">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="1" data-group="4">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="1" data-group="4">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="1" data-group="4">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="1" data-group="4">5胆</button>
            </div>
          </div>
          
          <!-- 第5组筛选条件 -->
          <div class="filter-group mb-2 pb-0">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="1" data-group="5">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="1" data-group="5">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="1" data-group="5">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="1" data-group="5">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="1" data-group="5">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="1" data-group="5">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="1" data-group="5">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="1" data-group="5">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="1" data-group="5">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="1" data-group="5">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="1" data-group="5">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="1" data-group="5">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="1" data-group="5">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="1" data-group="5">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="1" data-group="5">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="1" data-group="5">5胆</button>
            </div>
          </div>
        </div>
        
        <!-- 右侧卡片 - 模块2 (5组筛选条件) -->
        <div id="module2" class="border border-gray-200 rounded-lg p-4 five-star-module">
          <!-- 模块级共享容错选择器 -->
          <div class="flex items-center mb-2 pb-4 border-b">
            <span class="text-gray-600 mr-2">模块容错</span>
            <select class="tolerance-min border border-gray-300 rounded px-2 py-1 text-sm" data-module="2">
              <option>0</option>
            </select>
            <span class="mx-2">至</span>
            <select class="tolerance-max border border-gray-300 rounded px-2 py-1 text-sm" data-module="2">
              <option>0</option>
            </select>
          </div>
          
          <!-- 第1组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="2" data-group="1">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="2" data-group="1">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="2" data-group="1">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="2" data-group="1">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="2" data-group="1">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="2" data-group="1">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="2" data-group="1">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="2" data-group="1">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="2" data-group="1">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="2" data-group="1">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="2" data-group="1">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="2" data-group="1">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="2" data-group="1">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="2" data-group="1">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="2" data-group="1">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="2" data-group="1">5胆</button>
            </div>
          </div>
          
          <!-- 第2组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="2" data-group="2">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="2" data-group="2">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="2" data-group="2">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="2" data-group="2">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="2" data-group="2">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="2" data-group="2">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="2" data-group="2">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="2" data-group="2">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="2" data-group="2">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="2" data-group="2">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="2" data-group="2">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="2" data-group="2">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="2" data-group="2">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="2" data-group="2">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="2" data-group="2">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="2" data-group="2">5胆</button>
            </div>
          </div>
          
          <!-- 第3组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="2" data-group="3">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="2" data-group="3">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="2" data-group="3">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="2" data-group="3">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="2" data-group="3">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="2" data-group="3">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="2" data-group="3">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="2" data-group="3">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="2" data-group="3">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="2" data-group="3">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="2" data-group="3">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="2" data-group="3">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="2" data-group="3">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="2" data-group="3">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="2" data-group="3">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="2" data-group="3">5胆</button>
            </div>
          </div>
          
          <!-- 第4组筛选条件 -->
          <div class="filter-group mb-2 pb-0 border-b">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="2" data-group="4">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="2" data-group="4">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="2" data-group="4">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="2" data-group="4">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="2" data-group="4">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="2" data-group="4">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="2" data-group="4">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="2" data-group="4">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="2" data-group="4">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="2" data-group="4">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="2" data-group="4">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="2" data-group="4">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="2" data-group="4">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="2" data-group="4">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="2" data-group="4">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="2" data-group="4">5胆</button>
            </div>
          </div>
          
          <!-- 第5组筛选条件 -->
          <div class="filter-group mb-2 pb-0">
            <div class="flex flex-wrap gap-2 mb-2 number-buttons">
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="1" data-module="2" data-group="5">01</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="2" data-module="2" data-group="5">02</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="3" data-module="2" data-group="5">03</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="4" data-module="2" data-group="5">04</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="5" data-module="2" data-group="5">05</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="6" data-module="2" data-group="5">06</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="7" data-module="2" data-group="5">07</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="8" data-module="2" data-group="5">08</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="9" data-module="2" data-group="5">09</button>
              <button class="number-btn w-10 h-10 border border-gray-300 rounded flex items-center justify-center text-sm" data-number="10" data-module="2" data-group="5">10</button>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-2 dama-buttons">
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="0" data-module="2" data-group="5">0胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="1" data-module="2" data-group="5">1胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="2" data-module="2" data-group="5">2胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="3" data-module="2" data-group="5">3胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="4" data-module="2" data-group="5">4胆</button>
              <button class="dama-btn px-3 py-1 border border-gray-300 rounded text-sm" data-dama="5" data-module="2" data-group="5">5胆</button>
            </div>
          </div>
        </div>
        </div>
        
        <!-- 底部操作区域 -->
        <div class="mt-6 flex flex-wrap gap-4 justify-center">
          <button id="generateCombos" class="px-6 py-2 bg-primary text-white rounded-md hover:bg-primary/80 transition-colors">
            <i class="fa fa-magic mr-2"></i>生成组合
          </button>
          <button id="clearAll" class="px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">
            <i class="fa fa-trash mr-2"></i>清空所有
          </button>
        </div>
        
        <!-- 结果显示区域 -->
        <div id="fiveStarResults" class="mt-6 bg-gray-50 rounded-lg p-4 hidden">
          <h3 class="text-lg font-semibold mb-3">生成的组合</h3>
          <div id="combosList" class="space-y-2"></div>
        </div>
        </div>
      </div>
    </div>
  </main>

  <!-- 帮助模态框 -->
  <div id="helpModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-y-auto">
      <div class="p-5 border-b border-gray-200 flex justify-between items-center">
        <h3 class="text-xl font-bold text-gray-800">使用帮助</h3>
        <button id="closeHelpBtn" class="text-gray-400 hover:text-gray-600 transition-colors">
          <i class="fa fa-times text-xl"></i>
        </button>
      </div>
      <div class="p-5">
        
        <h4 class="font-medium text-lg mb-2">使用方法</h4>
        <ol class="list-decimal list-inside space-y-2 mb-4">
          <li>您可以手动输入数据或使用自动获取功能获取最新的开奖结果</li>
          <li>选择胆码数和中出条件来筛选感兴趣的组合</li>
          <li>您也可以添加自定义组合进行分析</li>
          <li>使用排序功能可以按照连中次数或遗漏次数对组合进行排序</li>
          <li>表格中的"连"表示历史最大连中次数，"漏"表示历史最大遗漏次数</li>
          <li>您可以通过表格上方的期数按钮选择显示最新的30期、50期或100期数据</li>
          <li>使用表格上方的水平滑块可以左右滚动表格内容</li>
          <li>使用表格右侧的垂直滑块可以上下滚动表格内容</li>
        </ol>
        
        <h4 class="font-medium text-lg mb-2">数据格式</h4>
        <p class="mb-4">手动输入数据时，请按照"期数 数据"的格式，例如：202504181232 02,05,01,04,07,10,09,03,06,08 </p>
        
        <h4 class="font-medium text-lg mb-2">五星做号</h4>
        <p class="mb-4">五星做号功能允许您设置多个筛选条件，通过组合不同的胆码数来生成号码组合。</p>
        
        <h4 class="font-medium text-lg mb-2">注意事项</h4>
        <ul class="list-disc list-inside space-y-1">
          <li>数据分析基于历史开奖结果，仅供参考</li>
          <li>请理性投注，注意风险控制</li>
          <li>建议结合多种分析方法进行综合判断</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // 全局变量
    let allData = [];
    let filteredData = [];
    let currentSort = 'consecutive';
    let currentPeriod = 30;
    let currentView = 'miss';
    let currentMode = 'current';
    let horizontalScrollPosition = 0;
    let verticalScrollPosition = 0;
    let maxHorizontalScroll = 0;
    let maxVerticalScroll = 0;
    let isDarkMode = false;
    
    // 初始化
    document.addEventListener('DOMContentLoaded', function() {
      initializeButtons();
      initializeEventListeners();
      initializeSliders();
      initializeFiveStarPage();
      loadTheme();
      
      // 检查密钥有效期
      checkKeyExpiry();
    });
    
    // 检查密钥有效期
    function checkKeyExpiry() {
      const expiryDate = new Date('2025-12-31T23:59:59');
      const now = new Date();
      
      if (now < expiryDate) {
        const timeRemaining = expiryDate - now;
        const days = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
        
        document.getElementById('timeRemaining').textContent = `${days}天 ${hours}小时 ${minutes}分钟 ${seconds}秒`;
        document.getElementById('keyCountdown').classList.remove('hidden');
        
        // 每秒更新倒计时
        setInterval(() => {
          const now = new Date();
          if (now >= expiryDate) {
            document.body.innerHTML = '<div class="flex items-center justify-center min-h-screen bg-gray-100"><div class="text-center"><h1 class="text-2xl font-bold text-red-600 mb-4">密钥已过期</h1><p class="text-gray-600">请联系管理员续费</p></div></div>';
            return;
          }
          
          const timeRemaining = expiryDate - now;
          const days = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
          const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
          
          document.getElementById('timeRemaining').textContent = `${days}天 ${hours}小时 ${minutes}分钟 ${seconds}秒`;
        }, 1000);
      } else {
        document.body.innerHTML = '<div class="flex items-center justify-center min-h-screen bg-gray-100"><div class="text-center"><h1 class="text-2xl font-bold text-red-600 mb-4">密钥已过期</h1><p class="text-gray-600">请联系管理员续费</p></div></div>';
      }
    }
    
    // 主题切换
    function loadTheme() {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        enableDarkMode();
      }
    }
    
    function enableDarkMode() {
      isDarkMode = true;
      document.documentElement.classList.add('dark');
      document.getElementById('themeToggle').innerHTML = '<i class="fa fa-sun-o text-yellow-400"></i>';
      localStorage.setItem('theme', 'dark');
    }
    
    function disableDarkMode() {
      isDarkMode = false;
      document.documentElement.classList.remove('dark');
      document.getElementById('themeToggle').innerHTML = '<i class="fa fa-moon-o text-gray-500"></i>';
      localStorage.setItem('theme', 'light');
    }
    
    // 初始化按钮
    function initializeButtons() {
      // 胆码数按钮
      const numContainer = document.getElementById('numButtons');
      for (let i = 0; i <= 10; i++) {
        const btn = document.createElement('button');
        btn.textContent = `${i}胆`;
        btn.className = 'px-3 py-1 rounded-md bg-gray-200 btn-hover';
        btn.dataset.num = i;
        btn.addEventListener('click', () => toggleButton(btn, 'num'));
        numContainer.appendChild(btn);
      }
      
      // 中出按钮
      const hitContainer = document.getElementById('hitButtons');
      for (let i = 0; i <= 10; i++) {
        const btn = document.createElement('button');
        btn.textContent = `${i}中`;
        btn.className = 'px-3 py-1 rounded-md bg-gray-200 btn-hover';
        btn.dataset.hit = i;
        btn.addEventListener('click', () => toggleButton(btn, 'hit'));
        hitContainer.appendChild(btn);
      }
    }
    
    // 初始化事件监听器
    function initializeEventListeners() {
      // 页面切换
      document.getElementById('dataAnalysisBtn').addEventListener('click', () => switchPage('dataAnalysis'));
      document.getElementById('fiveStarBtn').addEventListener('click', () => switchPage('fiveStar'));
      
      // 主要功能按钮
      document.getElementById('calcBtn').addEventListener('click', calculateAnalysis);
      document.getElementById('autoFetchBtn').addEventListener('click', autoFetchData);
      document.getElementById('uploadDataBtn').addEventListener('click', uploadData);
      document.getElementById('sortToggle').addEventListener('click', toggleSort);
      document.getElementById('statBtn').addEventListener('click', updateStatistics);
      document.getElementById('exportBtn').addEventListener('click', exportData);
      document.getElementById('clearBtn').addEventListener('click', clearData);
      
      // 视图切换按钮
      document.getElementById('currentBtn').addEventListener('click', () => switchMode('current'));
      document.getElementById('historyBtn').addEventListener('click', () => switchMode('history'));
      document.getElementById('missBtn').addEventListener('click', () => switchView('miss'));
      document.getElementById('hitBtn').addEventListener('click', () => switchView('hit'));
      
      // 期数按钮
      document.querySelectorAll('.period-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const period = parseInt(btn.dataset.period);
          setPeriod(period);
        });
      });
      
      // 自定义期数
      document.getElementById('customPeriodBtn').addEventListener('click', () => {
        const customPeriod = parseInt(document.getElementById('customPeriod').value);
        if (customPeriod >= 1 && customPeriod <= 10000) {
          setPeriod(customPeriod);
        } else {
          alert('请输入1-10000之间的期数');
        }
      });
      
      // 帮助和主题
      document.getElementById('helpBtn').addEventListener('click', () => {
        document.getElementById('helpModal').classList.remove('hidden');
      });
      
      document.getElementById('closeHelpBtn').addEventListener('click', () => {
        document.getElementById('helpModal').classList.add('hidden');
      });
      
      document.getElementById('themeToggle').addEventListener('click', () => {
        if (isDarkMode) {
          disableDarkMode();
        } else {
          enableDarkMode();
        }
      });
      
      // 点击模态框外部关闭
      document.getElementById('helpModal').addEventListener('click', (e) => {
        if (e.target.id === 'helpModal') {
          document.getElementById('helpModal').classList.add('hidden');
        }
      });
    }
    
    // 页面切换
    function switchPage(page) {
      const dataAnalysisPage = document.getElementById('dataAnalysisPage');
      const fiveStarPage = document.getElementById('fiveStarPage');
      const dataAnalysisBtn = document.getElementById('dataAnalysisBtn');
      const fiveStarBtn = document.getElementById('fiveStarBtn');
      
      if (page === 'dataAnalysis') {
        dataAnalysisPage.classList.remove('hidden');
        fiveStarPage.classList.add('hidden');
        dataAnalysisBtn.classList.add('bg-primary', 'text-white');
        dataAnalysisBtn.classList.remove('bg-gray-600');
        fiveStarBtn.classList.remove('bg-primary', 'text-white');
        fiveStarBtn.classList.add('bg-gray-600');
      } else {
        dataAnalysisPage.classList.add('hidden');
        fiveStarPage.classList.remove('hidden');
        fiveStarBtn.classList.add('bg-primary', 'text-white');
        fiveStarBtn.classList.remove('bg-gray-600');
        dataAnalysisBtn.classList.remove('bg-primary', 'text-white');
        dataAnalysisBtn.classList.add('bg-gray-600');
      }
    }
    
    // 切换按钮状态
    function toggleButton(button, type) {
      button.classList.toggle('btn-active');
      updateTable();
    }
    
    // 设置期数
    function setPeriod(period) {
      currentPeriod = period;
      
      // 更新按钮状态
      document.querySelectorAll('.period-btn').forEach(btn => {
        btn.classList.remove('btn-active');
        if (parseInt(btn.dataset.period) === period) {
          btn.classList.add('btn-active');
        }
      });
      
      // 更新自定义期数输入框
      document.getElementById('customPeriod').value = period;
      
      updateTable();
    }
    
    // 切换视图模式
    function switchView(view) {
      currentView = view;
      
      const missBtn = document.getElementById('missBtn');
      const hitBtn = document.getElementById('hitBtn');
      
      if (view === 'miss') {
        missBtn.classList.add('btn-active');
        hitBtn.classList.remove('btn-active');
      } else {
        hitBtn.classList.add('btn-active');
        missBtn.classList.remove('btn-active');
      }
      
      updateTable();
    }
    
    // 切换模式
    function switchMode(mode) {
      currentMode = mode;
      
      const currentBtn = document.getElementById('currentBtn');
      const historyBtn = document.getElementById('historyBtn');
      
      if (mode === 'current') {
        currentBtn.classList.add('btn-active');
        historyBtn.classList.remove('btn-active');
        currentBtn.textContent = '当前';
        historyBtn.textContent = '历史';
      } else {
        historyBtn.classList.add('btn-active');
        currentBtn.classList.remove('btn-active');
        currentBtn.textContent = '历史';
        historyBtn.textContent = '当前';
      }
      
      updateTable();
    }
    
    // 切换排序
    function toggleSort() {
      const sortText = document.getElementById('sortText');
      if (currentSort === 'consecutive') {
        currentSort = 'missing';
        sortText.textContent = '按遗漏次数排序';
      } else {
        currentSort = 'consecutive';
        sortText.textContent = '按连中次数排序';
      }
      updateTable();
    }
    
    // 计算分析
    function calculateAnalysis() {
      const input = document.getElementById('numbersInput').value.trim();
      if (!input) {
        alert('请输入数据');
        return;
      }
      
      try {
        const lines = input.split('\n').filter(line => line.trim());
        const newData = [];
        
        for (const line of lines) {
          const parts = line.trim().split(/\s+/);
          if (parts.length >= 2) {
            const period = parts[0];
            const numbersStr = parts.slice(1).join(' ');
            const numbers = numbersStr.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n) && n >= 1 && n <= 10);
            
            if (numbers.length === 10) {
              newData.push({ period, numbers });
            }
          }
        }
        
        if (newData.length === 0) {
          alert('未找到有效数据，请检查格式');
          return;
        }
        
        // 合并新数据到现有数据
        for (const item of newData) {
          const existingIndex = allData.findIndex(d => d.period === item.period);
          if (existingIndex >= 0) {
            allData[existingIndex] = item;
          } else {
            allData.push(item);
          }
        }
        
        // 按期数排序
        allData.sort((a, b) => b.period.localeCompare(a.period));
        
        updateTable();
        document.getElementById('output').textContent = `成功处理 ${newData.length} 期数据，总计 ${allData.length} 期`;
        
      } catch (error) {
        console.error('数据处理错误:', error);
        alert('数据处理失败，请检查格式');
      }
    }
    
    // 自动获取数据
    async function autoFetchData() {
      try {
        document.getElementById('output').textContent = '正在获取数据...';
        
        // 这里应该是实际的API调用
        // 暂时使用模拟数据
        const mockData = generateMockData(50);
        
        allData = mockData;
        updateTable();
        document.getElementById('output').textContent = `自动获取成功，共 ${allData.length} 期数据`;
        
      } catch (error) {
        console.error('自动获取数据失败:', error);
        document.getElementById('output').textContent = '自动获取数据失败';
      }
    }
    
    // 生成模拟数据
    function generateMockData(count) {
      const data = [];
      const baseDate = new Date();
      
      for (let i = 0; i < count; i++) {
        const date = new Date(baseDate.getTime() - i * 24 * 60 * 60 * 1000);
        const period = date.getFullYear().toString() + 
                      (date.getMonth() + 1).toString().padStart(2, '0') + 
                      date.getDate().toString().padStart(2, '0') + 
                      '1232';
        
        const numbers = [];
        while (numbers.length < 10) {
          const num = Math.floor(Math.random() * 10) + 1;
          if (!numbers.includes(num)) {
            numbers.push(num);
          }
        }
        
        data.push({ period, numbers });
      }
      
      return data;
    }
    
    // 上传数据文件
    function uploadData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.txt,.csv';
      
      input.onchange = function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById('numbersInput').value = e.target.result;
          calculateAnalysis();
        };
        reader.readAsText(file);
      };
      
      input.click();
    }
    
    // 更新统计
    function updateStatistics() {
      if (filteredData.length === 0) {
        document.getElementById('summary').textContent = '暂无数据';
        return;
      }
      
      const stats = calculateStatistics(filteredData);
      const summary = `共 ${filteredData.length} 个组合，平均连中 ${stats.avgConsecutive.toFixed(1)} 次，平均遗漏 ${stats.avgMissing.toFixed(1)} 次`;
      document.getElementById('summary').textContent = summary;
    }
    
    // 计算统计信息
    function calculateStatistics(data) {
      const totalConsecutive = data.reduce((sum, item) => sum + (item.maxConsecutive || 0), 0);
      const totalMissing = data.reduce((sum, item) => sum + (item.maxMissing || 0), 0);
      
      return {
        avgConsecutive: data.length > 0 ? totalConsecutive / data.length : 0,
        avgMissing: data.length > 0 ? totalMissing / data.length : 0
      };
    }
    
    // 导出数据
    function exportData() {
      if (filteredData.length === 0) {
        alert('暂无数据可导出');
        return;
      }
      
      let csvContent = '组合,最大连中,最大遗漏,当前状态\n';
      
      filteredData.forEach(item => {
        const combo = item.combination.join(',');
        const maxConsecutive = item.maxConsecutive || 0;
        const maxMissing = item.maxMissing || 0;
        const currentStatus = item.currentMiss || 0;
        csvContent += `"${combo}",${maxConsecutive},${maxMissing},${currentStatus}\n`;
      });
      
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `台湾PK分析_${new Date().toISOString().slice(0, 10)}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
    
    // 清空数据
    function clearData() {
      if (confirm('确定要清空所有数据吗？')) {
        allData = [];
        filteredData = [];
        updateTable();
        document.getElementById('numbersInput').value = '';
        document.getElementById('output').textContent = '数据已清空';
      }
    }
    
    // 更新表格
    function updateTable() {
      if (allData.length === 0) {
        document.getElementById('resultTable').innerHTML = '<tbody><tr><td colspan="100%" class="text-center py-8 text-gray-500">暂无数据</td></tr></tbody>';
        document.getElementById('periodCount').textContent = '0';
        return;
      }
      
      // 获取筛选条件
      const selectedNums = getSelectedValues('num');
      const selectedHits = getSelectedValues('hit');
      const customCombos = getCustomCombinations();
      
      // 生成所有可能的组合
      let combinations = [];
      
      // 添加基于胆码数的组合
      if (selectedNums.length > 0) {
        for (const num of selectedNums) {
          combinations = combinations.concat(generateCombinations(num));
        }
      }
      
      // 添加自定义组合
      combinations = combinations.concat(customCombos);
      
      // 去重
      combinations = [...new Set(combinations.map(c => c.join(',')))].
        map(c => c.split(',').map(n => parseInt(n)));
      
      if (combinations.length === 0) {
        combinations = generateCombinations(3); // 默认显示3胆组合
      }
      
      // 分析每个组合
      filteredData = combinations.map(combo => {
        const analysis = analyzeCombination(combo, allData.slice(0, currentPeriod));
        return {
          combination: combo,
          ...analysis
        };
      });
      
      // 根据中出筛选
      if (selectedHits.length > 0) {
        filteredData = filteredData.filter(item => {
          const hitCount = item.hitHistory ? item.hitHistory.filter(h => h).length : 0;
          return selectedHits.includes(hitCount);
        });
      }
      
      // 排序
      if (currentSort === 'consecutive') {
        filteredData.sort((a, b) => (b.maxConsecutive || 0) - (a.maxConsecutive || 0));
      } else {
        filteredData.sort((a, b) => (b.maxMissing || 0) - (a.maxMissing || 0));
      }
      
      renderTable();
      updateStatistics();
      updateSliders();
      
      document.getElementById('periodCount').textContent = Math.min(currentPeriod, allData.length);
    }
    
    // 获取选中的值
    function getSelectedValues(type) {
      const buttons = document.querySelectorAll(`[data-${type}]`);
      const selected = [];
      
      buttons.forEach(btn => {
        if (btn.classList.contains('btn-active')) {
          selected.push(parseInt(btn.dataset[type]));
        }
      });
      
      return selected;
    }
    
    // 获取自定义组合
    function getCustomCombinations() {
      const input = document.getElementById('customCombos').value.trim();
      if (!input) return [];
      
      const combinations = [];
      const lines = input.split(/\s+/);
      
      for (const line of lines) {
        const numbers = line.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n) && n >= 1 && n <= 10);
        if (numbers.length > 0) {
          combinations.push(numbers);
        }
      }
      
      return combinations;
    }
    
    // 生成组合
    function generateCombinations(count) {
      const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
      const combinations = [];
      
      function combine(arr, k, start = 0, current = []) {
        if (current.length === k) {
          combinations.push([...current]);
          return;
        }
        
        for (let i = start; i < arr.length; i++) {
          current.push(arr[i]);
          combine(arr, k, i + 1, current);
          current.pop();
        }
      }
      
      combine(numbers, count);
      return combinations;
    }
    
    // 分析组合
    function analyzeCombination(combination, data) {
      const hitHistory = [];
      let maxConsecutive = 0;
      let maxMissing = 0;
      let currentConsecutive = 0;
      let currentMiss = 0;
      let lastHit = false;
      
      for (let i = 0; i < data.length; i++) {
        const period = data[i];
        const hit = combination.every(num => period.numbers.includes(num));
        hitHistory.push(hit);
        
        if (hit) {
          currentConsecutive++;
          if (currentMiss > maxMissing) {
            maxMissing = currentMiss;
          }
          currentMiss = 0;
          lastHit = true;
        } else {
          if (currentConsecutive > maxConsecutive) {
            maxConsecutive = currentConsecutive;
          }
          currentConsecutive = 0;
          currentMiss++;
          lastHit = false;
        }
      }
      
      // 更新最终的最大值
      if (currentConsecutive > maxConsecutive) {
        maxConsecutive = currentConsecutive;
      }
      if (currentMiss > maxMissing) {
        maxMissing = currentMiss;
      }
      
      return {
        hitHistory,
        maxConsecutive,
        maxMissing,
        currentConsecutive: lastHit ? currentConsecutive : 0,
        currentMiss: lastHit ? 0 : currentMiss
      };
    }
    
    // 渲染表格
    function renderTable() {
      const table = document.getElementById('resultTable');
      const displayData = allData.slice(0, currentPeriod);
      
      if (filteredData.length === 0) {
        table.innerHTML = '<tbody><tr><td colspan="100%" class="text-center py-8 text-gray-500">暂无符合条件的数据</td></tr></tbody>';
        return;
      }
      
      // 创建表头
      let headerHtml = '<thead class="bg-gray-50 sticky-header sticky-bg-gray-50"><tr>';
      headerHtml += '<th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky-col left-0 sticky-bg-gray-50 fixed-width-period">组合</th>';
      headerHtml += '<th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky-col left-[120px] sticky-bg-gray-50 fixed-width-data">统计</th>';
      
      // 期数列
      for (let i = 0; i < displayData.length; i++) {
        const period = displayData[i].period;
        const shortPeriod = period.slice(-4); // 只显示最后4位
        headerHtml += `<th class="px-2 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[40px]">${shortPeriod}</th>`;
      }
      
      headerHtml += '</tr></thead>';
      
      // 创建表体
      let bodyHtml = '<tbody class="bg-white divide-y divide-gray-200">';
      
      filteredData.forEach((item, index) => {
        const rowClass = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';
        bodyHtml += `<tr class="${rowClass}">`;
        
        // 组合列
        const comboText = item.combination.map(n => n.toString().padStart(2, '0')).join(',');
        bodyHtml += `<td class="px-3 py-2 text-sm font-medium text-gray-900 sticky-col left-0 ${rowClass} fixed-width-period">${comboText}</td>`;
        
        // 统计列
        let statText = '';
        if (currentView === 'miss') {
          statText = currentMode === 'current' ? 
            `漏${item.currentMiss}` : 
            `连${item.maxConsecutive} 漏${item.maxMissing}`;
        } else {
          statText = currentMode === 'current' ? 
            `连${item.currentConsecutive}` : 
            `连${item.maxConsecutive} 漏${item.maxMissing}`;
        }
        
        bodyHtml += `<td class="px-3 py-2 text-sm text-gray-900 sticky-col left-[120px] ${rowClass} fixed-width-data">${statText}</td>`;
        
        // 期数数据列
        for (let i = 0; i < displayData.length; i++) {
          const hit = item.hitHistory && item.hitHistory[i];
          const cellClass = hit ? 'hit-cell' : 'miss-cell';
          const cellText = hit ? '●' : '○';
          bodyHtml += `<td class="px-2 py-2 text-center text-sm ${cellClass} min-w-[40px]">${cellText}</td>`;
        }
        
        bodyHtml += '</tr>';
      });
      
      bodyHtml += '</tbody>';
      
      table.innerHTML = headerHtml + bodyHtml;
    }
    
    // 初始化滑块
    function initializeSliders() {
      const horizontalThumb = document.getElementById('horizontalThumb');
      const verticalThumb = document.getElementById('verticalThumb');
      
      // 水平滑块
      let isDraggingHorizontal = false;
      
      horizontalThumb.addEventListener('mousedown', (e) => {
        isDraggingHorizontal = true;
        e.preventDefault();
      });
      
      document.addEventListener('mousemove', (e) => {
        if (isDraggingHorizontal) {
          updateHorizontalSlider(e);
        }
      });
      
      document.addEventListener('mouseup', () => {
        isDraggingHorizontal = false;
      });
      
      // 垂直滑块
      let isDraggingVertical = false;
      
      verticalThumb.addEventListener('mousedown', (e) => {
        isDraggingVertical = true;
        e.preventDefault();
      });
      
      document.addEventListener('mousemove', (e) => {
        if (isDraggingVertical) {
          updateVerticalSlider(e);
        }
      });
      
      document.addEventListener('mouseup', () => {
        isDraggingVertical = false;
      });
    }
    
    // 更新滑块
    function updateSliders() {
      const tableContainer = document.getElementById('tableContainer');
      const table = document.getElementById('resultTable');
      
      if (!table || !tableContainer) return;
      
      // 计算最大滚动距离
      maxHorizontalScroll = Math.max(0, table.scrollWidth - tableContainer.clientWidth);
      maxVerticalScroll = Math.max(0, table.scrollHeight - tableContainer.clientHeight);
      
      // 更新滑块位置
      updateHorizontalSliderPosition();
      updateVerticalSliderPosition();
    }
    
    // 更新水平滑块
    function updateHorizontalSlider(e) {
      const sliderContainer = document.querySelector('.slider-container');
      const rect = sliderContainer.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const percentage = Math.max(0, Math.min(1, x / rect.width));
      
      horizontalScrollPosition = percentage * maxHorizontalScroll;
      
      const tableContainer = document.getElementById('tableContainer');
      tableContainer.scrollLeft = horizontalScrollPosition;
      
      updateHorizontalSliderPosition();
    }
    
    // 更新垂直滑块
    function updateVerticalSlider(e) {
      const sliderContainer = document.getElementById('verticalSlider');
      const rect = sliderContainer.getBoundingClientRect();
      const y = e.clientY - rect.top;
      const percentage = Math.max(0, Math.min(1, y / rect.height));
      
      verticalScrollPosition = percentage * maxVerticalScroll;
      
      const tableContainer = document.getElementById('tableContainer');
      tableContainer.scrollTop = verticalScrollPosition;
      
      updateVerticalSliderPosition();
    }
    
    // 更新水平滑块位置
    function updateHorizontalSliderPosition() {
      const percentage = maxHorizontalScroll > 0 ? horizontalScrollPosition / maxHorizontalScroll : 0;
      const thumb = document.getElementById('horizontalThumb');
      const fill = document.getElementById('horizontalFill');
      
      if (thumb && fill) {
        const sliderContainer = document.querySelector('.slider-container');
        const maxLeft = sliderContainer.clientWidth - thumb.clientWidth;
        const left = percentage * maxLeft;
        
        thumb.style.left = `${left}px`;
        fill.style.width = `${percentage * 100}%`;
      }
    }
    
    // 更新垂直滑块位置
    function updateVerticalSliderPosition() {
      const percentage = maxVerticalScroll > 0 ? verticalScrollPosition / maxVerticalScroll : 0;
      const thumb = document.getElementById('verticalThumb');
      const fill = document.getElementById('verticalFill');
      
      if (thumb && fill) {
        const sliderContainer = document.getElementById('verticalSlider');
        const maxTop = sliderContainer.clientHeight - thumb.clientHeight;
        const top = percentage * maxTop;
        
        thumb.style.top = `${top}px`;
        fill.style.height = `${percentage * 100}%`;
        fill.style.bottom = `${(1 - percentage) * 100}%`;
      }
    }
    
    // 五星做号页面初始化
    function initializeFiveStarPage() {
      // 初始化容错选择器
      initializeToleranceSelectors();
      
      // 初始化按钮事件
      initializeFiveStarButtons();
      
      // 生成组合按钮
      document.getElementById('generateCombos').addEventListener('click', generateFiveStarCombos);
      
      // 清空所有按钮
      document.getElementById('clearAll').addEventListener('click', clearAllFiveStarSelections);
    }
    
    // 初始化容错选择器
    function initializeToleranceSelectors() {
      const toleranceSelectors = document.querySelectorAll('.tolerance-min, .tolerance-max');
      
      toleranceSelectors.forEach(selector => {
        // 清空现有选项
        selector.innerHTML = '';
        
        // 添加0-5的选项
        for (let i = 0; i <= 5; i++) {
          const option = document.createElement('option');
          option.value = i;
          option.textContent = i;
          selector.appendChild(option);
        }
      });
    }
    
    // 初始化五星做号按钮
    function initializeFiveStarButtons() {
      // 数字按钮点击事件
      document.querySelectorAll('.number-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          btn.classList.toggle('bg-primary');
          btn.classList.toggle('text-white');
        });
      });
      
      // 胆码按钮点击事件
      document.querySelectorAll('.dama-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          // 清除同组其他胆码按钮的选中状态
          const module = btn.dataset.module;
          const group = btn.dataset.group;
          const sameGroupBtns = document.querySelectorAll(`[data-module="${module}"][data-group="${group}"].dama-btn`);
          
          sameGroupBtns.forEach(b => {
            b.classList.remove('bg-primary', 'text-white');
          });
          
          // 选中当前按钮
          btn.classList.add('bg-primary', 'text-white');
        });
      });
    }
    
    // 生成五星组合
    function generateFiveStarCombos() {
      const modules = [1, 2];
      const allCombos = [];
      
      for (const moduleId of modules) {
        const moduleData = getFiveStarModuleData(moduleId);
        if (moduleData.groups.length === 0) continue;
        
        const moduleCombos = generateModuleCombinations(moduleData);
        allCombos.push(...moduleCombos);
      }
      
      if (allCombos.length === 0) {
        alert('请至少选择一个模块的筛选条件');
        return;
      }
      
      displayFiveStarResults(allCombos);
    }
    
    // 获取五星模块数据
    function getFiveStarModuleData(moduleId) {
      const groups = [];
      const toleranceMin = parseInt(document.querySelector(`.tolerance-min[data-module="${moduleId}"]`).value);
      const toleranceMax = parseInt(document.querySelector(`.tolerance-max[data-module="${moduleId}"]`).value);
      
      for (let groupId = 1; groupId <= 5; groupId++) {
        const selectedNumbers = [];
        const selectedDama = getDamaSelection(moduleId, groupId);
        
        // 获取选中的数字
        const numberBtns = document.querySelectorAll(`[data-module="${moduleId}"][data-group="${groupId}"].number-btn`);
        numberBtns.forEach(btn => {
          if (btn.classList.contains('bg-primary')) {
            selectedNumbers.push(parseInt(btn.dataset.number));
          }
        });
        
        if (selectedNumbers.length > 0 || selectedDama !== null) {
          groups.push({
            id: groupId,
            numbers: selectedNumbers,
            dama: selectedDama
          });
        }
      }
      
      return {
        id: moduleId,
        groups,
        toleranceMin,
        toleranceMax
      };
    }
    
    // 获取胆码选择
    function getDamaSelection(moduleId, groupId) {
      const damaBtns = document.querySelectorAll(`[data-module="${moduleId}"][data-group="${groupId}"].dama-btn`);
      
      for (const btn of damaBtns) {
        if (btn.classList.contains('bg-primary')) {
          return parseInt(btn.dataset.dama);
        }
      }
      
      return null;
    }
    
    // 生成模块组合
    function generateModuleCombinations(moduleData) {
      // 这里应该实现复杂的组合生成逻辑
      // 暂时返回示例数据
      const combinations = [];
      
      // 简化的组合生成逻辑
      for (let i = 0; i < 10; i++) {
        const combo = [];
        for (let j = 0; j < 5; j++) {
          combo.push(Math.floor(Math.random() * 10) + 1);
        }
        combinations.push(combo);
      }
      
      return combinations;
    }
    
    // 显示五星结果
    function displayFiveStarResults(combinations) {
      const resultsDiv = document.getElementById('fiveStarResults');
      const combosList = document.getElementById('combosList');
      
      if (combinations.length === 0) {
        resultsDiv.classList.add('hidden');
        return;
      }
      
      let html = '';
      combinations.forEach((combo, index) => {
        const comboText = combo.map(n => n.toString().padStart(2, '0')).join(' ');
        html += `<div class="p-2 bg-white rounded border">${index + 1}. ${comboText}</div>`;
      });
      
      combosList.innerHTML = html;
      resultsDiv.classList.remove('hidden');
    }
    
    // 清空所有五星选择
    function clearAllFiveStarSelections() {
      // 清空数字按钮
      document.querySelectorAll('.number-btn').forEach(btn => {
        btn.classList.remove('bg-primary', 'text-white');
      });
      
      // 清空胆码按钮
      document.querySelectorAll('.dama-btn').forEach(btn => {
        btn.classList.remove('bg-primary', 'text-white');
      });
      
      // 重置容错选择器
      document.querySelectorAll('.tolerance-min, .tolerance-max').forEach(selector => {
        selector.value = '0';
      });
      
      // 隐藏结果
      document.getElementById('fiveStarResults').classList.add('hidden');
    }
  </script>
</body>
</html>